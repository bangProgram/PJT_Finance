<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE  mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="interestMapper">

	<sql id="whereReport">
		<if test="pAccountIds != null and pAccountIds != '' ">
			AND replace(account_id, 'ifrs_', 'ifrs-full_') IN 
			<foreach collection="pAccountIds" item="item" open="(" close=")" separator=",">
				#{item}
			</foreach>
		</if>
		
		<if test="chkCorpList != null and chkCorpList != '' ">
			AND A.CORP_CODE IN 
			(
			<foreach collection="chkCorpList" item="item" separator=",">
				#{item}
			</foreach>
			)
		</if>
		<if test="(pStartYear != null and pStartYear != '') or (pEndYear != null and pEndYear != '') ">
			AND A.BSNS_YEAR BETWEEN #{pStartYear} AND #{pEndYear}
		</if>
		<if test="pCorpName != null and pCorpName != '' ">
			AND B.CORP_NAME like '%'|| #{pCorpName} ||'%'
		</if>
	</sql>
	
	<insert id="insert" parameterType="hashMap" useGeneratedKeys="true" keyProperty="book_id">  
	    insert into book
	    (title, category, price) 
	    values
	    (#{title}, #{category}, #{price})
	</insert>
	
	<select id="getBsnsYearList"  parameterType="hashMap" resultType="HashMap">
		SELECT 
		     ROWNUM, BSNS_YEAR, REPRT_CODE, DECODE(REPRT_CODE,'11011','Q4_','11012','Q2_')||BSNS_YEAR AS HAEDER_NM
		FROM (
		    SELECT 
		        BSNS_YEAR, REPRT_CODE
		    FROM TB_BPLC_CIS
		    WHERE 1=1
		    	<if test="pReportCd == '11011' ">
		    		and reprt_code = '11011'
		    	</if>
		    GROUP BY 
		        BSNS_YEAR, REPRT_CODE 
		    ORDER BY 
		        BSNS_YEAR DESC
		)
		WHERE 1=1
		<![CDATA[
		     AND ROWNUM <= 5
		]]>
		
	</select>
</mapper>