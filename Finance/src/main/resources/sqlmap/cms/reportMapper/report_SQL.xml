<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE  mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="reportMapper">
	
	<insert id="insert" parameterType="hashMap" useGeneratedKeys="true" keyProperty="book_id">  
	    insert into book
	    (title, category, price) 
	    values
	    (#{title}, #{category}, #{price})
	</insert>
	
	<select id="getPortFolioList" parameterType="hashMap" resultType="HashMap">  
	    select
		    a.CORP_CODE,
		    a.ACCOUNT_ID,
		    a.NET_AMOUNT,
		    a.ACCUMULATED_NET_AMOUNT,
		    lead(a.ACCUMULATED_NET_AMOUNT)
		    over(partition by a.CORP_CODE, a.ACCOUNT_ID
		         order by
		             a.CORP_CODE, a.BSNS_YEAR desc, a.REPRT_CODE asc
		    ) as "LEAD_ACCUMULATED_NET_AMOUNT",
		    a.BSNS_YEAR,
		    a.REPRT_CODE
		from
		    TB_BPLC_CIS a, TB_BPLC b
		where
		        a.CORP_CODE = b.STOCK_CODE
		where 1=1
		    and ( b.CORP_NAME = '삼성전자' )
		order by
		    a.CORP_CODE,
		    a.ACCOUNT_ID,
		    a.BSNS_YEAR desc,
		    a.REPRT_CODE
	</select>
	
</mapper>