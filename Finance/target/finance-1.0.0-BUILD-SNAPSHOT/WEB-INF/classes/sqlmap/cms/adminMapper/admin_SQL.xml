<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE  mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminMapper">
	
	<insert id="mergeReport" parameterType="hashMap"  >  
		BEGIN
		MERGE 
		 	INTO TB_BPLC_REPORT a
		USING dual
		   ON (
		   		a.CORP_CODE = #{COL_1}
				and a.BSNS_YEAR = #{BSNS_YEAR}
				and a.REPRT_CODE = #{REPRT_CODE}
				and a.SJ_DIV = #{SJ_DIV}
				and a.ACCOUNT_ID = #{COL_10}
		   	)
		 WHEN MATCHED THEN
		      UPDATE
		        <set>
		        	<if test="COL_12 != null and COL_12 != '' ">
						NET_AMOUNT		=	#{COL_12},
					</if>
					<if test="COL_13 != null and COL_13 != '' ">
						ACCUMULATED_NET_AMOUNT		=	#{COL_13},
					</if>
					<if test="COL_14 != null and COL_14 != '' ">
						BEF_NET_AMOUNT		=	#{COL_14},
					</if>
					<if test="COL_15 != null and COL_15 != '' ">
						BEF_ACCUMULATED_NET_AMOUNT		=	#{COL_15},
					</if>
		         	a.CURRENCY = 'SYSTEM_JB'
				</set>
			 WHEN NOT MATCHED THEN
					INSERT (
					    CORP_CODE
						,BSNS_YEAR
						,REPRT_CODE
						,REPRT_NM
						,CLOSING_DATE
						,SJ_DIV
						,SJ_NM
						,ACCOUNT_ID
						,ACCOUNT_NM
						,NET_AMOUNT
						,ACCUMULATED_NET_AMOUNT
						,BEF_NET_AMOUNT
						,BEF_ACCUMULATED_NET_AMOUNT
						,CURRENCY	
					) VALUES (
						#{COL_1}
						,#{BSNS_YEAR}
						,#{REPRT_CODE}
						,#{REPRT_NM}
						,#{COL_7}
						,#{SJ_DIV}
						,#{SJ_NM}
						,#{COL_10}
						,#{COL_11}
						,#{COL_12}
						,#{COL_13}
						,#{COL_14}
						,#{COL_15}
						,#{COL_9}
					)
	    			;
		   	
		END;
	</insert>
		
	
</mapper>